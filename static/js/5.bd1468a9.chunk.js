(this["webpackJsonpusda-react"]=this["webpackJsonpusda-react"]||[]).push([[5],{146:function(e,t,n){"use strict";n.r(t),n.d(t,"TablePage",(function(){return ue}));var a=n(33),c=n(38),r=n(3),u=n(101),o=n(85),i=n(0),l=n.n(i),s=n(21),b=n(515),m=n(34),O=n(45),j=n(9),f=n(94),d=n.n(f),p=n(92),v=n.n(p),h=n(93),g=n.n(h),E=n(507),k=n.n(E),y=n(508),N=n.n(y),S=n(509),x=n.n(S),w=n(510),C=n.n(w),R=n(511),B=n.n(R),D=n(512),P=n.n(D),I=n(24),J=n.n(I),K=n(312),M=n.n(K),q=n(13),A=n(315),F=function(e){return e.app.reports},L=Object(A.a)([F],Object.keys),T=(Object(A.a)([F],Object.values),n(47)),U=n(98),V=n(99),z=n(102),G=n(100),H=function(e){Object(z.a)(n,e);var t=Object(G.a)(n);function n(e){var a;return Object(U.a)(this,n),(a=t.call(this,e)).state={error:null},a}return Object(V.a)(n,[{key:"componentDidCatch",value:function(e,t){console.error(e,t)}},{key:"render",value:function(){return this.state.hasError?l.a.createElement("code",null,"error in subtree"):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{error:e}}}]),n}(l.a.Component),Q=n(514),W=n(199);function X(){var e=Object(a.a)(["\n                margin-top: 1rem;\n              "]);return X=function(){return e},e}function Y(){var e=Object(a.a)(["\n            display: flex;\n            flex-direction: column;\n            margin-right: 1rem;\n            min-width: 200px;\n          "]);return Y=function(){return e},e}function Z(){var e=Object(a.a)(["\n          display: flex;\n          flex-direction: row;\n        "]);return Z=function(){return e},e}var $=function(e){return e.reduce((function(e,t){return Object(r.a)(Object(r.a)({},e),{},Object(c.a)({},t.name,Object(r.a)({selected:["Proximates"].includes(t.group)},t)))}),{})},_=function(e){var t=e.nutrients,n=e.setNutrients,a=e.className,u=Object(Q.a)(e,["nutrients","setNutrients","className"]),s=Object(i.useState)($(t)),b=Object(o.a)(s,2),O=b[0],j=b[1],f=Object(I.groupBy)(Object.values(O),"group");Object(i.useEffect)((function(){j((function(e){return Object(r.a)(Object(r.a)({},$(t)),e)}))}),[t]),Object(i.useEffect)((function(){n(Object.values(O))}),[O,n]);var d=function(e,t){j(Object(I.mapValues)(O,(function(n){return n.group===e?Object(I.set)(n,"selected",t):n})))},p=function(e){return j((function(t){return Object(r.a)(Object(r.a)({},t),{},Object(c.a)({},e,Object(r.a)(Object(r.a)({},t[e]),{},{selected:!t[e].selected})))}))};return l.a.createElement("div",Object.assign({className:Object(m.a)(Z())+" ".concat(a)},u),Object(I.map)(f,(function(e,t){return l.a.createElement("div",{key:t,className:Object(m.a)(Y())},l.a.createElement("h4",null,t),l.a.createElement("hr",null),Object(I.map)(e,(function(e){var t=e.name;return l.a.createElement("label",{key:t},l.a.createElement("input",{type:"checkbox",name:t,checked:O[t]&&O[t].selected,onChange:Object(I.partial)(p,t)}),t)})),e.length>1&&l.a.createElement("div",{className:Object(m.a)(X())},l.a.createElement(W.a,{onClick:Object(I.partial)(d,t,!0)},"Select All")," ","\xb7"," ",l.a.createElement(W.a,{onClick:Object(I.partial)(d,t,!1)},"Select None")))})))},ee=n(513);function te(){var e=Object(a.a)(["\n          margin-top: 2rem;\n        "]);return te=function(){return e},e}function ne(){var e=Object(a.a)(["\n          margin-top: 2rem;\n        "]);return ne=function(){return e},e}function ae(){var e=Object(a.a)(["\n        padding: 2rem 1rem;\n      "]);return ae=function(){return e},e}var ce=[d.a[300],v.a[300],g.a[300],k.a[300],N.a[300],x.a[300],C.a[300],B.a[300],P.a[300]],re=[{name:"Name",sortable:!0,compact:!0,selector:function(e){return Object(I.get)(e,"desc.name")},cell:function(e){return l.a.createElement(O.a,{to:"/report/".concat(e.desc.ndbno)},e.desc.name)}}],ue=function(e){var t=e.ids,n=e.cachedIds,a=e.reports,s=e.getReport,O=e.compareSet;Object(b.a)((function(){Object(I.difference)(t,n).forEach(s)}),[t,n,s]),Object(b.a)((function(){O(t.map((function(e){return{ndbno:e,amount:100}})))}),[t,O]);var j=Object(i.useMemo)((function(){return Object(I.chain)(a).map("nutrients").flatMap(Object.values).sortBy(T.e).map(Object(I.partial)(I.pick,J.a,["name","group"])).uniq().value()}),[a]),f=Object(i.useState)(null),d=Object(o.a)(f,2),p=d[0],v=d[1],h=Object(I.chain)(p).filter("selected").map((function(e){return{name:e.name,selector:function(t){return Number(Object(I.get)(t,["nutrients",e.name,"value"]))},format:function(t){return Object(T.c)(t,e.name,1,2)},sortable:!0,compact:!0}})).value(),g=[].concat(re,Object(u.a)(h)),E=Object(i.useState)(),k=Object(o.a)(E,2),y=k[0],N=k[1],S=y?Object(I.sortBy)(a,y.selector):a;y&&"asc"!==y.direction&&(S=S.reverse());var x=a.reduce((function(e,t){return Object(r.a)(Object(r.a)({},e),{},Object(c.a)({},t.desc.ndbno,Object(I.indexOf)(S,t)))}),{}),w=Object(I.chain)(h).map((function(e){return Object(r.a)({name:e.name},Object(I.reduce)(a,(function(t,n){return Object(r.a)(Object(r.a)({},t),{},Object(c.a)({},x[n.desc.ndbno],Object(T.d)(e.name,n,1,2)))}),{}))})).value();return l.a.createElement("div",{className:Object(m.a)(ae())},l.a.createElement(_,{nutrients:j,setNutrients:v,className:Object(m.a)(ne())}),l.a.createElement(H,null,l.a.createElement(M.a,{columns:g,data:a,title:"Reports",responsive:!0,dense:!0,onSort:function(e,t){return N(Object(r.a)(Object(r.a)({},e),{},{direction:t}))}})),l.a.createElement(ee.e,{width:"100%",height:300,className:Object(m.a)(te())},l.a.createElement(ee.b,{data:w},l.a.createElement(ee.c,{strokeDasharray:"3 3"}),l.a.createElement(ee.g,{dataKey:"name"}),l.a.createElement(ee.h,null),l.a.createElement(ee.f,null),l.a.createElement(ee.d,null),S.map((function(e,t){return l.a.createElement(ee.a,{key:t,dataKey:t,name:S[t].desc.name,fill:ce[a.indexOf(e)%ce.length]})})))))},oe={getReport:q.e,compareSet:q.d};t.default=Object(s.c)((function(e){var t=new URLSearchParams(Object(I.get)(e,"router.location.search","")).get("ids"),n=t?t.split(","):[];return{cachedIds:L(e),ids:n,reports:Object.values(Object(I.pick)(F(e),n)).map(T.f)}}),oe)(Object(j.g)(ue))},199:function(e,t,n){"use strict";var a=n(33);function c(){var e=Object(a.a)(["\n  background-color: transparent;\n  border: none;\n  cursor: pointer;\n  display: inline;\n  margin: 0;\n  padding: 0;\n  color: #5e5e5e;\n\n  &:hover {\n    color: #f06292;\n  }\n"]);return c=function(){return e},e}var r=n(228).a.button(c());t.a=r}}]);
//# sourceMappingURL=5.bd1468a9.chunk.js.map